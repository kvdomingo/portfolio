---
import Layout from "@/layouts/Layout.astro";
import info from "@/info.json";
import { buildCldUrl } from "@/utils/cloudinary";

export function getStaticPaths() {
  return info.svip.courses.map(course => ({
    params: { courseSlug: course.slug },
  }));
}

const { courseSlug = "" } = Astro.params;

const course = info.svip.courses.find(course => course.slug === courseSlug);
---

<Layout title={`${course.title} | KVD Studio`}>
  <div class="container flex flex-col gap-4">
    <div class="breadcrumbs">
      <ul>
        <li><a href="/svip">Courses</a></li>
        <li>{course.name}</li>
      </ul>
    </div>

    <div class="grid grid-cols-3 gap-4">
      {
        course.posts.map(post => (
          <div class="card image-full aspect-square bg-base-300 shadow-xl">
            <figure>
              <img
                src={buildCldUrl(post.cover)}
                alt={post.title}
                class="aspect-square"
              />
            </figure>
            <a href={`/svip/${course.slug}/${post.slug}`} class="card-body">
              <h2 class="card-title">{post.title}</h2>
            </a>
          </div>
        ))
      }
    </div>
  </div>
</Layout>
